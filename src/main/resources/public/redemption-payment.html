<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
		<!-- 网站作者 -->
		<meta name="author" content="51区块研发团队">
		<!-- 网站关键词 -->
		<meta name="keywords" content="51区块,数字资产">
		<!-- 网站描述 -->
		<meta name="description" content="51区块">

		<title>赎回兑付| 51区块</title>

		<!-- Bootstrap.css -->
		<link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css">

		<!-- bootstrapValidator.css -->
		<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap-validator/0.5.3/css/bootstrapValidator.min.css">

		<!-- public.css -->
		<link rel="stylesheet" href="/css/public.css">

		<!-- jQuery.js 1.11.1-->
		<script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>

		<!-- Bootstrap.js -->
		<script src="http://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>

		<!-- vue.js -->
		<script src="//cdn.bootcss.com/vue/1.0.24/vue.js"></script>
		<script src="//cdn.bootcss.com/vue-router/0.7.10/vue-router.min.js"></script>

		<!-- jquery.cookie.js -->
		<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.js"></script>

		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.0/bootstrap-table.min.css">
		<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.0/bootstrap-table.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.0/locale/bootstrap-table-zh-CN.min.js"></script>

		<link href="/css/animate.css" rel="stylesheet">
	    <link href="/css/style.css?v=4.1.0" rel="stylesheet">

	</head>
	<body class="gray-bg">
	    <div class="wrapper wrapper-content animated fadeIn container-fluid">
	        <div class="row">
	            <div class="col-sm-12">
	                 <!-- <h3 class="">
	                	
	                </h3> -->
	                <h3 class="bs-callout-success">
	                	赎回兑付
		            </h3>
	            </div>
	            <div class="col-sm-12">
	            	<table id="table" data-toggle="table" data-pagination="true" data-search="true" data-use-row-attr-func="true" data-reorderable-rows="true">
			        <!-- <table id="table" data-toggle="table" data-pagination="true" data-search="true" data-use-row-attr-func="true" data-reorderable-rows="true" data-url="/js/a.json"> -->
						<thead>
							<tr>
								<th data-field="name">
									资产名称
								</th>
								<th data-field="id">
									资产编号
								</th>
								<th data-field="time" >
									到期时间
								</th>
								<th data-field="status" >
									状态
								</th>
								<th data-field="operation">
									操作
								</th>
							</tr>
						</thead>
					</table>
	            </div>
	        </div>
	    </div>
	</body>
	<!-- 全局js -->
    <script src="js/plugins/jquery.metisMenu.js"></script>
    <!-- 滚动条 -->
    <script src="js/plugins/jquery.slimscroll.min.js"></script>
    <!-- 公共js文件 -->
    <script src="js/public.js"></script>
    <!-- 第三方插件 -->
    <script src="js/plugins/pace.min.js"></script>
    <script>
		var data = new Array();
		// 表格嵌入数据
		$.get('/assets/maturity', function (result) {
			//成功返回表格数据
			for (var i = 0; i < result.data.length; i++) {
				data[i] = new Array();
				data[i]["name"]="<a href=" + "/assetsDetail/"+result.data[i].assetId+">" + result.data[i].assetName + "</a>";
				data[i]["id"]=result.data[i].assetId;
				data[i]["time"]=result.data[i]["endTime"];
				data[i]["status"]=result.data[i]["status"]["message"];
				console.log(result.data[i]);
				for(var j=0;j<result.data[i]["operations"].length;j++){
					console.log(result.data[i]["operations"][j]["message"]);
					data[i]["operation"]="<a href=\"javascript:void(0);\" onclick=\"clearAssets("+result.data[i].assetId+")\">"+result.data[i]["operations"][j]["message"]+"</a>";
				}
			}
			console.log(data);
			$("#table").bootstrapTable("load",{
				data: data
			});

		})
		function clearAssets(assetId) {
			$.ajax({
				url : "/assets/"+assetId+"/clear",
				type : "post",
				success: function(result){
					console.log(result);
					if(result.meta.code==200){
						$("#modalAlert",parent.document).click();
						$(".modal-body",parent.document).html("赎回成功");
					}else{
						$("#modalAlert",parent.document).click();
						$(".modal-body",parent.document).html("赎回失败，请稍后再试");
					}
				}
			})
		}
    </script>
</html>